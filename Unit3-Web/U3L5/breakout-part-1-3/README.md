Final code at the end of Part 3: Collision